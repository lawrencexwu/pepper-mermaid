<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Typing Practice</title>
    
    <!-- AdSense code -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2542902506864184"
     crossorigin="anonymous"></script>
    
    <!-- Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body { background-color: #f0f2f5; margin: 0; padding: 10px; }
    </style>
</head>
<body>
    <div class="max-w-3xl mx-auto">
        <!-- Compact Header with Side Ad -->
        <div class="flex gap-2 mb-2">
            <div class="flex-1">
                <h1 class="text-lg font-bold">YouTube Typing Practice</h1>
                <p class="text-sm text-gray-600">Type to practice while watching videos!</p>
            </div>
            <!-- AdSense Ad Unit -->
            <div class="w-[300px] h-[50px]">
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-2542902506864184"
                     data-ad-slot="6403379011"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="bg-white rounded shadow-sm p-3">
            <div id="root"></div>
        </div>
    </div>

    <script type="text/babel">
        const TypingTutor = () => {
            const [currentText, setCurrentText] = React.useState('');
            const [userInput, setUserInput] = React.useState('');
            const [isPaused, setIsPaused] = React.useState(false);
            const [startTime, setStartTime] = React.useState(null);
            const [pausedTime, setPausedTime] = React.useState(0);
            const [lastPauseTime, setLastPauseTime] = React.useState(null);
            const [stats, setStats] = React.useState({
                wpm: 0,
                accuracy: 100,
                errors: 0,
                completedTexts: 0
            });

            const paragraphs = [
                "The quick brown fox jumps over the lazy dog. This pangram contains every letter of the English alphabet at least once.",
                "Learning to type efficiently is a valuable skill in today's digital world. With practice, your speed will increase.",
                "While watching YouTube videos, you can improve your typing skills. This is a great way to multitask.",
                "Technology continues to shape how we work and communicate. Typing quickly and accurately is important.",
                "The best way to improve at anything is through consistent practice. Small improvements add up over time."
            ];

            const getRandomParagraph = () => paragraphs[Math.floor(Math.random() * paragraphs.length)];

            React.useEffect(() => {
                setCurrentText(getRandomParagraph());
            }, []);

            const calculateTimeDelta = () => {
                if (!startTime) return 0;
                const now = Date.now();
                const totalPausedTime = pausedTime + (lastPauseTime ? now - lastPauseTime : 0);
                return (now - startTime - (isPaused ? totalPausedTime : pausedTime)) / 1000 / 60;
            };

            const handleInput = (e) => {
                if (isPaused) return;
                
                const input = e.target.value;
                setUserInput(input);

                if (!startTime && input) {
                    setStartTime(Date.now());
                }

                let errors = 0;
                for (let i = 0; i < input.length; i++) {
                    if (input[i] !== currentText[i]) errors++;
                }

                const accuracy = input.length > 0 
                    ? ((input.length - errors) / input.length * 100).toFixed(1)
                    : 100;

                const timeElapsed = calculateTimeDelta();
                const wpm = timeElapsed > 0
                    ? Math.round((input.length / 5) / timeElapsed)
                    : 0;

                setStats(prev => ({
                    ...prev,
                    wpm,
                    accuracy,
                    errors
                }));

                if (input === currentText) {
                    setUserInput('');
                    setCurrentText(getRandomParagraph());
                    setStartTime(null);
                    setPausedTime(0);
                    setLastPauseTime(null);
                    setStats(prev => ({
                        ...prev,
                        completedTexts: prev.completedTexts + 1
                    }));
                }
            };

            const togglePause = () => {
                setIsPaused(prev => {
                    if (!prev) {
                        setLastPauseTime(Date.now());
                    } else {
                        setPausedTime(prev => prev + (Date.now() - lastPauseTime));
                        setLastPauseTime(null);
                    }
                    return !prev;
                });
            };

            const reset = () => {
                setUserInput('');
                setCurrentText(getRandomParagraph());
                setStartTime(null);
                setPausedTime(0);
                setLastPauseTime(null);
                setIsPaused(false);
                setStats({
                    wpm: 0,
                    accuracy: 100,
                    errors: 0,
                    completedTexts: 0
                });
            };

            const renderText = () => {
                const parts = [];
                for (let i = 0; i < Math.max(currentText.length, userInput.length); i++) {
                    if (i < userInput.length) {
                        if (currentText[i] === userInput[i]) {
                            parts.push(<span key={i} className="text-green-600">{currentText[i]}</span>);
                        } else {
                            parts.push(
                                <span key={i} className="text-red-600 bg-red-100">
                                    {currentText[i] || ' '}
                                </span>
                            );
                        }
                    } else {
                        parts.push(<span key={i}>{currentText[i]}</span>);
                    }
                }
                return parts;
            };

            return (
                <div>
                    {/* Compact Stats Bar */}
                    <div class="flex justify-between text-sm mb-2">
                        <div class="flex gap-4">
                            <span>WPM: <strong>{stats.wpm}</strong></span>
                            <span>Accuracy: <strong>{stats.accuracy}%</strong></span>
                            <span>Errors: <strong>{stats.errors}</strong></span>
                        </div>
                        <div class="flex gap-2">
                            <button
                                onClick={togglePause}
                                className="px-2 py-1 bg-blue-500 text-white text-sm rounded hover:bg-blue-600"
                            >
                                {isPaused ? 'Resume' : 'Pause'}
                            </button>
                            <button
                                onClick={reset}
                                className="px-2 py-1 bg-gray-500 text-white text-sm rounded hover:bg-gray-600"
                            >
                                Reset
                            </button>
                        </div>
                    </div>

                    {/* Text Display Area */}
                    <div className="mb-2 p-2 bg-gray-100 rounded text-sm">
                        <p className="font-mono leading-snug">
                            {renderText()}
                        </p>
                    </div>

                    {/* Input Area */}
                    <textarea
                        value={userInput}
                        onChange={handleInput}
                        disabled={isPaused}
                        className={`w-full p-2 border rounded font-mono text-sm ${
                            isPaused ? 'bg-gray-100' : ''
                        }`}
                        rows={2}
                        autoFocus
                    />

                    {isPaused && (
                        <div className="mt-1 text-xs text-blue-600">
                            Paused - press Resume to continue
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<TypingTutor />);
    </script>
</body>
</html>
