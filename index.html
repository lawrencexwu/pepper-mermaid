<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Typing Practice</title>
    
    <!-- AdSense code -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2542902506864184"
     crossorigin="anonymous"></script>
    
    <!-- Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body { 
            background-color: #f0f2f5; 
            margin: 0; 
            padding: 10px; 
        }

        @keyframes matrixRain {
            0% { transform: translateY(-100%); opacity: 0; }
            5% { opacity: 1; }
            95% { opacity: 1; }
            100% { transform: translateY(100%); opacity: 0; }
        }

        @keyframes flash {
            0% { opacity: 0; }
            10% { opacity: 1; }
            30% { opacity: 0; }
            40% { opacity: 0.7; }
            50% { opacity: 0; }
            60% { opacity: 0.4; }
            70% { opacity: 0; }
            80% { opacity: 0.2; }
            100% { opacity: 0; }
        }

        @keyframes fadeOut {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }

        .matrix-rain {
            position: absolute;
            width: 2px;
            background: linear-gradient(180deg, 
                rgba(0,255,0,0) 0%, 
                #0f0 20%, 
                #0f0 80%, 
                rgba(0,255,0,0) 100%
            );
        }

        .matrix-char {
            position: absolute;
            color: #0f0;
            font-family: monospace;
            font-size: 14px;
            text-shadow: 0 0 8px #0f0;
            animation: fadeOut 0.5s linear forwards;
            animation-delay: 1.5s;
        }

        @media (max-width: 640px) {
            body {
                padding: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="max-w-3xl mx-auto">
        <!-- Compact Header with Side Ad -->
        <div class="flex flex-col sm:flex-row gap-2 mb-2">
            <div class="flex-1">
                <h1 class="text-lg font-bold">YouTube Typing Practice</h1>
                <p class="text-sm text-gray-600">Type to practice while watching videos!</p>
            </div>
            <!-- AdSense Ad Unit -->
            <div class="w-full sm:w-[300px] h-[50px]">
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-2542902506864184"
                     data-ad-slot="6403379011"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
                <script>
                     (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="bg-white rounded shadow-sm p-3">
            <div id="root"></div>
        </div>
    </div>

    <script type="text/babel">
        const TypingTutor = () => {
            const [currentText, setCurrentText] = React.useState('');
            const [userInput, setUserInput] = React.useState('');
            const [isPaused, setIsPaused] = React.useState(false);
            const [startTime, setStartTime] = React.useState(null);
            const [pausedTime, setPausedTime] = React.useState(0);
            const [lastPauseTime, setLastPauseTime] = React.useState(null);
            const [showMatrix, setShowMatrix] = React.useState(false);
            const [stats, setStats] = React.useState({
                wpm: 0,
                accuracy: 100,
                errors: 0,
                completedTexts: 0
            });

            const paragraphs = [
                "The quick brown fox jumps over the lazy dog. This pangram contains every letter of the English alphabet at least once.",
                "Learning to type efficiently is a valuable skill in today's digital world. With practice, your speed will increase.",
                "While watching YouTube videos, you can improve your typing skills. This is a great way to multitask.",
                "Technology continues to shape how we work and communicate. Typing quickly and accurately is important.",
                "The best way to improve at anything is through consistent practice. Small improvements add up over time."
            ];

            const getRandomParagraph = () => {
                return paragraphs[Math.floor(Math.random() * paragraphs.length)];
            };

            React.useEffect(() => {
                setCurrentText(getRandomParagraph());
            }, []);

            const calculateTimeDelta = () => {
                if (!startTime) return 0;
                const now = Date.now();
                const totalPausedTime = pausedTime + (lastPauseTime ? now - lastPauseTime : 0);
                return (now - startTime - (isPaused ? totalPausedTime : pausedTime)) / 1000 / 60;
            };

            const triggerMatrixEffect = () => {
                setShowMatrix(true);
                setTimeout(() => setShowMatrix(false), 2000);
            };

            const handleInput = (e) => {
                if (isPaused) return;
                
                const input = e.target.value;
                setUserInput(input);

                if (!startTime && input) {
                    setStartTime(Date.now());
                }

                let errors = 0;
                for (let i = 0; i < input.length; i++) {
                    if (input[i] !== currentText[i]) errors++;
                }

                const accuracy = input.length > 0 
                    ? ((input.length - errors) / input.length * 100).toFixed(1)
                    : 100;

                const timeElapsed = calculateTimeDelta();
                const wpm = timeElapsed > 0
                    ? Math.round((input.length / 5) / timeElapsed)
                    : 0;

                setStats(prev => ({
                    ...prev,
                    wpm,
                    accuracy,
                    errors
                }));

                if (input === currentText) {
                    triggerMatrixEffect();
                    setTimeout(() => {
                        setUserInput('');
                        setCurrentText(getRandomParagraph());
                        setStartTime(null);
                        setPausedTime(0);
                        setLastPauseTime(null);
                        setStats(prev => ({
                            ...prev,
                            completedTexts: prev.completedTexts + 1
                        }));
                    }, 1500);
                }
            };

            const togglePause = () => {
                setIsPaused(prev => {
                    if (!prev) {
                        setLastPauseTime(Date.now());
                    } else {
                        setPausedTime(prev => prev + (Date.now() - lastPauseTime));
                        setLastPauseTime(null);
                    }
                    return !prev;
                });
            };

            const reset = () => {
                setUserInput('');
                setCurrentText(getRandomParagraph());
                setStartTime(null);
                setPausedTime(0);
                setLastPauseTime(null);
                setIsPaused(false);
                setShowMatrix(false);
                setStats({
                    wpm: 0,
                    accuracy: 100,
                    errors: 0,
                    completedTexts: 0
                });
            };

            const renderText = () => {
                const parts = [];
                for (let i = 0; i < Math.max(currentText.length, userInput.length); i++) {
                    if (i < userInput.length) {
                        if (currentText[i] === userInput[i]) {
                            parts.push(<span key={i} className="text-green-600">{currentText[i]}</span>);
                        } else {
                            parts.push(
                                <span key={i} className="text-red-600 bg-red-100">
                                    {currentText[i] || ' '}
                                </span>
                            );
                        }
                    } else {
                        parts.push(<span key={i}>{currentText[i]}</span>);
                    }
                }
                return parts;
            };

            return (
                <div>
                    {/* Compact Stats Bar - Mobile Responsive */}
                    <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center text-sm mb-2 gap-2">
                        <div className="flex flex-wrap gap-4">
                            <span>WPM: <strong>{stats.wpm}</strong></span>
                            <span>Accuracy: <strong>{stats.accuracy}%</strong></span>
                            <span>Errors: <strong>{stats.errors}</strong></span>
                        </div>
                        <div className="flex gap-2">
                            <button
                                onClick={togglePause}
                                className="px-4 py-2 sm:px-2 sm:py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-base sm:text-sm"
                            >
                                {isPaused ? 'Resume' : 'Pause'}
                            </button>
                            <button
                                onClick={reset}
                                className="px-4 py-2 sm:px-2 sm:py-1 bg-gray-500 text-white rounded hover:bg-gray-600 text-base sm:text-sm"
                            >
                                Reset
                            </button>
                        </div>
                    </div>

                    {/* Text Display Area with Matrix Effect */}
                    <div className="relative mb-2 p-3 bg-gray-50 rounded text-base sm:text-lg">
                        <p className="font-mono leading-relaxed">
                            {renderText()}
                        </p>
                        
                        {/* Matrix Animation */}
                        {showMatrix && (
                            <div className="absolute inset-0" style={{ perspective: '1000px' }}>
                                {/* Flash effect */}
                                <div 
                                    className="absolute inset-0 bg-green-500"
                                    style={{ 
                                        animation: 'flash 1s linear forwards',
                                        opacity: 0
                                    }}
                                />
                                
                                {/* Multiple layers of rain */}
                                {[...Array(30)].map((_, i) => (
                                    <div
                                        key={i}
                                        className="matrix-rain"
                                        style={{
                                            left: `${(i * 3.33)}%`,
                                            height: '200%',
                                            opacity: Math.random() * 0.5 + 0.5,
                                            animation: `matrixRain ${1 + Math.random() * 0.5}s linear forwards`,
                                            animationDelay: `${Math.random() * 0.5}s`
                                        }}
                                    />
                                ))}

                                {/* Random Matrix characters */}
                                {[...Array(50)].map((_, i) => (
                                    <div
                                        key={`char-${i}`}
                                        className="matrix-char"
                                        style={{
                                            left: `${Math.random() * 100}%`,
                                            top: `${Math.random() * 100}%`,
                                            transform: 'scale(1.5)'
                                        }}
                                    >
                                        {String.fromCharCode(0x30A0 + Math.random() * 96)}
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>

                    {/* Input Area - Mobile Responsive */}
                    <textarea
                        value={userInput}
                        onChange={handleInput}
                        disabled={isPaused}
                        className={`w-full p-3 border rounded font-mono text-base sm:text-lg ${
                            isPaused ? 'bg-gray-100' : ''
                        }`}
                        rows={3}
                        autoFocus
                    />

                    {isPaused && (
                        <div className="mt-1 text-xs text-blue-600">
                            Paused - press Resume to continue
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<TypingTutor />);
    </script>
</body>
</html>
